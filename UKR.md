
# Аналіз проєкту та комп'ютерний зір

## Вступ
Проєкт передбачає використання комп'ютерного зору для аналізу зображень та автоматизації задач. Одним із ключових елементів є обробка вхідних даних, зокрема застосування фільтрів, виділення контурів та розпізнавання об'єктів.

Кожен піксель зображення можна представляти як елемент матриці **I** *x, y*, де *x* і *y* — це координати пікселя, а значення **I** *x, y* представляє інтенсивність кольору або яскравості.

---

## Приклади фільтрів для обробки зображень
Для обробки зображень використовуються різноманітні ядра (фільтри). Основні види фільтрів:

1. **Виділення контурів**
2. **Різкість**
3. **Розмиття**

### 1. Виділення контурів (оператор Собеля)
Оператор Собеля — це диференційний фільтр, що використовується для виявлення контурів зображення. Його можна виразити за допомогою згортки:


![image](https://github.com/user-attachments/assets/925d8774-0f9b-4b3c-811f-139d1feb95e5)


Тут **G***x* і **G***y* — це фільтри для обчислення градієнтів:

![image](https://github.com/user-attachments/assets/3b5bcff1-b4c7-4f8e-8742-708994d6b035)

Це дозволяє виявити різкі зміни інтенсивності і тим самим знайти контури об'єктів на зображенні.

Код для виділення контурів:

```python
import cv2

# Завантаження зображення
image = cv2.imread("input.png")

# Перетворення у відтінки сірого
gray_image = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

# Виділення контурів
edges = cv2.Canny(gray_image, 50, 150)

# Збереження результату
cv2.imwrite('edges_output.jpg', edges)
```

---

## Автоматизація аналізу

Для автоматизації ми використовуємо алгоритми на основі бібліотек OpenCV та Matplotlib. Основні етапи:

1. Зчитування зображення.
2. Перетворення у відтінки сірого.
3. Виділення контурів.
4. Сегментація об'єктів.

### Код для сегментації об'єктів

Сегментація зображення полягає у виділенні зв'язних компонентів. Це може бути виконано, наприклад, за допомогою методу "заливання" чи знаходження компонент за допомогою функції:


де кожен контур описується як набір координат *x*, *y* для пікселів, що належать одному об'єкту.

```python
# Пошук контурів
contours, _ = cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

# Малювання контурів
for contour in contours:
    x, y, w, h = cv2.boundingRect(contour)
    cv2.rectangle(image, (x, y), (x + w, y + h), (0, 255, 0), 2)

# Збереження результату
cv2.imwrite('segmented_image.jpg', image)
```

---

## Генерація тестових зображень

Щоб протестувати алгоритми, можна створити власні набори зображень. При генерації тестових зображень можна використати рівняння для створення геометричних фігур.

Це означає, що для кожного згенерованого прямокутника визначаються координати верхнього лівого кута і нижнього правого кута.

```python
import random
from PIL import Image, ImageDraw
import os

def random_color():
    return tuple(random.randint(0, 255) for _ in range(3))

def generate_test_images(num_images=10, img_size=(300, 300), output_folder="test_images"):
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)

    for i in range(1, num_images + 1):
        img = Image.new("RGB", img_size, color=(255, 255, 255))
        draw = ImageDraw.Draw(img)

        for _ in range(random.randint(10, 50)):
            x1, y1 = random.randint(0, img_size[0] - 50), random.randint(0, img_size[1] - 50)
            x2, y2 = x1 + random.randint(10, 50), y1 + random.randint(10, 50)
            draw.rectangle([x1, y1, x2, y2], fill=random_color(), outline=random_color())

        img.save(os.path.join(output_folder, f"image_{i}.png"))

# Генерація зображень
generate_test_images()
```

---

## Параметри Canny для виділення контурів

Алгоритм Canny має два основних параметри, що впливають на результат:

- **Threshold1** (нижній поріг): визначає мінімальну інтенсивність градієнта для контуру.
- **Threshold2** (верхній поріг): визначає максимальну інтенсивність градієнта для контуру.

Алгоритм Canny використовує градієнт для визначення контурів і застосовує дві умови для відбору значущих контурів.

### Приклад з використанням різних значень параметрів

```python
# Змінюємо пороги
edges_low = cv2.Canny(gray_image, 30, 100)
edges_high = cv2.Canny(gray_image, 100, 200)

# Збереження результатів
cv2.imwrite('edges_low.jpg', edges_low)
cv2.imwrite('edges_high.jpg', edges_high)
```

---

## Висновки
Комп'ютерний зір відкриває безліч можливостей для аналізу зображень, автоматизації задач та підвищення ефективності процесів. Застосування фільтрів, алгоритмів сегментації та візуалізації результатів є ключовими для успіху таких проєктів. Математичні методи, як-от градієнтні фільтри та методи згортки, дозволяють ефективно виділяти корисну інформацію з зображень і застосовувати її для розв'язання реальних задач.
